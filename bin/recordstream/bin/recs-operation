#!/usr/bin/perl -w

$| = 1;

use strict;

use FindBin qw($Script $RealScript);
use Recs::Operation;

if ( $Script eq $RealScript ) {
   print <<MESSAGE;
WARNING!
recs-operation invoked directly!

recs-operation is a wrapper for all other recs commands.  You do not want to
use this script.  It uses the Recs::Operation::* modules to performation
operations, like recs-grep.  If you are looking for implementation of those
scripts, look in those modules.  Otherwise, use a different recs script like
recs-grep or recs-collate directly.

Terminating program.
MESSAGE
   exit 1;
}

my @args = @ARGV;
@ARGV = ();

my $op = Recs::Operation->create_operation($Script, @args);

$op->run_operation();
$op->finish();

exit $op->get_exit_value();

# See perldoc perlopentut "Playing with STDIN and STDOUT"
# We need to close STDOUT so that we immeidately report pipe closures.  Can
# mess up recs-chain otherwise
END { close(STDOUT) || die "can't close stdout: $!" }
